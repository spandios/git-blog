# 시스템 변수

&#x20;Mysql 서버는 설정 파일의 내용을 읽어 메모리나 작동 박싱을 초기화 하고, 접속한 사용자를 제어하기 위해 이러한 값을 별도로 저장 해두는데, 이것을 시스템 변수라고 한다.&#x20;

```yaml
# 아래의 명령으로 시스템 변수를 확인할 수 있다.
SHOW VARIABLES or SHOW GLOBAL VARIABLES 
```

{% hint style="info" %}
아래의 레퍼런스를 통해 모든 시스템 변수에 대해 알아볼 수 있다.&#x20;

{% embed url="https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html" %}

<img src="../../../.gitbook/assets/스크린샷 2023-02-01 오후 11.22.08.png" alt="" data-size="original">
{% endhint %}



## 스코프

스코프는 글로벌과 세션으로 구분할 수 있는데, 글로별 변수 뿐 아니라 세션 변수에도 동시에 존재하는 Both도 존재한다.

### **글로벌 변수**

Mysql 서버에 전체적으로 영향을 미치는 시스템 변수. 주로 Mysql 서버 자체에 관련된 설정일 때가 많다.

### **세션 변수**

Mysql 클라리언트가 Mysql서버에 접속할 때 기본적으로 부여하는 옵션의 기본값을 제어하는데 사용된다.&#x20;

클라이언트의 필요에 따라 개별 컨넥션 단위로 다른 값으로 변경할 수 있는 것이 세션변수다. 별도로 지정하지 않다면 글로벌 시스템 변수이며, 각  클라이언트가 가지는 값이 세션 시스템 변수인 것이다.&#x20;

### **both 변수**

세션 변수 가운데 서버 설정파일에 명시해 초기화할 수 있는 변수는 대부분 범위가 Both로 명시돼 있다.  Mysql서버가 기억만 하고 있다가 실제 클라이언트와 컨넥션이 생성되는 순간 해당 컨넥션의 기본값으로 사용되는 값이다.&#x20;



## 정적 변수, 동적 변수와 변수 값 변경&#x20;

서버가 가동 중인 상태에서 변경이 가능한지 아닌지에 따라 정적 또는 동적으로 구분된다. 위에 표에서 dynamic이라는 항목이 바로 정적인지 동적인지를 말해준다.

변수를 변경하는 방법은 서버 설정 파일에서 값을 변경하는 것과 SET 명령으로 이미 가동 중인 서버의 메모리에 있는 변수를 변경하는 방법이 있다.&#x20;

### **설정 파일에서 변경**

my.cnf 파일에서 값을 설정 또는 변경하는 것으로 재시작을 해야하지만 적용 가능하다.

### **SET 명령으로 변경**

SET을 통해 값을 변경할 수 있다. 물론 정적 변수는 적용될 수 없을 것이다. 이 방법은 서버가 재시작 하면 초기화 되기 때문에 영구히 적용하려면 서버 설정 파일에서 변경해야 한다.

SHOW나 SET 명령에서 GLOBAL 키워드를 사용하면 Global, 그렇지 않다면 세션 변수에 대해 적용된다.&#x20;

```yaml
# show 명령어를 통해 변숫값을 확인할 수 있다. like를 통해 패턴 검색도 가능하다.
SHOW GLOBAL VARIABLES LIKE '%max_connections%';

# set 명령어를 통해 변수를 변경한다. 
SET GLOBAL max_connections=500;

```

Both 변수인 경우는 global 시스템 변수의 값을 변경해도 이미 존재하는 커넥션의 세션 변숫값은 변경되지 않고 그대로 유지된다.



### SET PERSIST

set명령은 동적 변수의 값을 변경하고 즉시 서버에 반영되지만, 서버가 재시작되면 변경점이 날라간다.

이런 문제점을 보완하기 위해 8.0버전 부터 SET PERSIST가 도입됐다.

```
SET PERISIT max_connections=5000;
```

이 명령으로 변경하면 변경된 값을 즉시 적용함과 동시에 별도의 설정 파일(mysqld-auto.cnf)에 변경 내용을 추가로 기록한다. Mysql은 재시작할 때 my.cnf를 거치고 mysqld-auto.cnf를 참조해서 시스템 변수를 적용하기 때문에 자동으로 영구 변경이 가능한 것이다.&#x20;

SET PERIST 명령은 세션 변수에는 적용되지 않는다. 자동으로 글로벌로 인식하고 변경한다.&#x20;

SET PERSIST ONLY 명령은 즉시 반영이되지는 않지만, mysqld-auto.cnf에 반영해 다음 재시작 때 적용되도록 할 수 있다.







